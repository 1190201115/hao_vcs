<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文档编辑器</title>
    <script src="../js/outService.js"></script>
    <script src="../ckeditor/ckeditor.js"></script>
</head>
<body>
<div id="app">
    <textarea id="textEditor">
    </textarea>
</div>

<script>
    var vm = new Vue({
        el: "#app",
        data() {
            return {
                editor: null,
                text: '<html>\n' +
                    '<head>\n' +
                    '<META http-equiv="Content-Type" content="text/html; charset=utf-8">\n' +
                    '<style type="text/css">.b1{white-space-collapsing:preserve;}\n' +
                    '.b2{margin: 0.59097224in 0.51180553in 0.27569443in 0.51180553in;}\n' +
                    '.s1{font-family:华文仿宋;font-size:18pt;font-weight:bold;}\n' +
                    '.s2{font-weight:bold;}\n' +
                    '.p1{margin-bottom:0.12986112in;text-align:center;hyphenate:auto;font-family:Times New Roman;font-size:10pt;}\n' +
                    '.p2{text-align:justify;hyphenate:auto;font-family:宋体;font-size:12pt;}\n' +
                    '.p3{margin-left:-0.12361111in;margin-right:-0.06527778in;text-align:center;hyphenate:auto;font-family:宋体;font-size:12pt;}\n' +
                    '.p4{margin-right:-0.06527778in;text-align:center;hyphenate:auto;font-family:宋体;font-size:12pt;}\n' +
                    '.p5{text-align:center;hyphenate:auto;font-family:宋体;font-size:12pt;}\n' +
                    '.p6{text-align:center;hyphenate:auto;font-family:Times New Roman;font-size:12pt;}\n' +
                    '.p7{text-align:justify;hyphenate:auto;font-family:Times New Roman;font-size:10pt;}\n' +
                    '.td1{width:0.98888886in;padding-start:0.0in;padding-end:0.0in;border-bottom:thin solid black;border-left:thin solid black;border-right:thin solid black;border-top:thin solid black;}\n' +
                    '.td2{width:1.0291667in;padding-start:0.0in;padding-end:0.0in;border-bottom:thin solid black;border-left:thin solid black;border-right:thin solid black;border-top:thin solid black;}\n' +
                    '.td3{width:0.7152778in;padding-start:0.0in;padding-end:0.0in;border-bottom:thin solid black;border-left:thin solid black;border-right:thin solid black;border-top:thin solid black;}\n' +
                    '.td4{width:1.1180556in;padding-start:0.0in;padding-end:0.0in;border-bottom:thin solid black;border-left:thin solid black;border-right:thin solid black;border-top:thin solid black;}\n' +
                    '.td5{width:1.0770833in;padding-start:0.0in;padding-end:0.0in;border-bottom:thin solid black;border-left:thin solid black;border-right:thin solid black;border-top:thin solid black;}\n' +
                    '.td6{width:0.8909722in;padding-start:0.0in;padding-end:0.0in;border-bottom:thin solid black;border-left:thin solid black;border-right:thin solid black;border-top:thin solid black;}\n' +
                    '.td7{width:1.05in;padding-start:0.0in;padding-end:0.0in;border-bottom:thin solid black;border-left:thin solid black;border-right:thin solid black;border-top:thin solid black;}\n' +
                    '.td8{width:0.5798611in;padding-start:0.0in;padding-end:0.0in;border-bottom:thin solid black;border-left:thin solid black;border-right:thin solid black;border-top:thin solid black;}\n' +
                    '.td9{width:2.5208333in;padding-start:0.0in;padding-end:0.0in;border-bottom:thin solid black;border-left:thin solid black;border-right:thin solid black;border-top:thin solid black;}\n' +
                    '.r1{height:0.31527779in;}\n' +
                    '.t1{table-layout:fixed;border-collapse:collapse;border-spacing:0;}\n' +
                    '</style>\n' +
                    '<title>深圳市普联技术有限公司</title>\n' +
                    '<meta content="wu" name="author">\n' +
                    '</head>\n' +
                    '<body class="b1 b2">\n' +
                    '<p class="p1">\n' +
                    '<img src="/bigWork/image/0859bdb1-7176-42c6-9285-d7adfffdbaf7-v1.0.0.doc\\s0.JPEG"><span class="s1">毕业生求职申请表</span>\n' +
                    '</p>\n' +
                    '<p class="p2">\n' +
                    '<span class="s2">应聘职位：云计算开发工程师                        填表时间：     2022年  11月  3 日</span>\n' +
                    '</p>\n' +
                    '<p class="p2"></p>\n' +
                    '<table class="t1">\n' +
                    '<tbody>\n' +
                    '<tr class="r1">\n' +
                    '<td class="td1">\n' +
                    '<p class="p3">\n' +
                    '<span class="s2">姓名</span>\n' +
                    '</p>\n' +
                    '</td><td class="td2">\n' +
                    '<p class="p4">\n' +
                    '<span>陈宇豪</span>\n' +
                    '</p>\n' +
                    '</td><td class="td3">\n' +
                    '<p class="p5">\n' +
                    '<span class="s2">姓名拼音</span>\n' +
                    '</p>\n' +
                    '</td><td class="td4">\n' +
                    '<p class="p5">\n' +
                    '<span>chenyuhao</span>\n' +
                    '</p>\n' +
                    '</td><td class="td5">\n' +
                    '<p class="p5">\n' +
                    '<span class="s2">性别</span>\n' +
                    '</p>\n' +
                    '</td><td class="td6">\n' +
                    '<p class="p5">\n' +
                    '<span>男</span>\n' +
                    '</p>\n' +
                    '</td><td class="td7">\n' +
                    '<p class="p5">\n' +
                    '<span class="s2">民族</span>\n' +
                    '</p>\n' +
                    '</td><td class="td8">\n' +
                    '<p class="p5">\n' +
                    '<span>汉</span>\n' +
                    '</p>\n' +
                    '</td>\n' +
                    '</tr>\n' +
                    '<tr class="r1">\n' +
                    '<td class="td1">\n' +
                    '<p class="p5">\n' +
                    '<span class="s2">出生日期</span>\n' +
                    '</p>\n' +
                    '</td><td class="td2">\n' +
                    '<p class="p4">\n' +
                    '<span>2001.08.28</span>\n' +
                    '</p>\n' +
                    '</td><td class="td3">\n' +
                    '<p class="p5">\n' +
                    '<span class="s2">联系电话</span>\n' +
                    '</p>\n' +
                    '</td><td class="td4">\n' +
                    '<p class="p5">\n' +
                    '<span>18845623922</span>\n' +
                    '</p>\n' +
                    '</td><td class="td5">\n' +
                    '<p class="p6">\n' +
                    '<span class="s2">联系地址</span>\n' +
                    '</p>\n' +
                    '</td><td class="td9" colspan="3">\n' +
                    '<p class="p5">\n' +
                    '<span>江西省上饶市广信区旭日街道育才路90号翰园小区</span>\n' +
                    '</p>\n' +
                    '</td>\n' +
                    '</tr>\n' +
                    '</tbody>\n' +
                    '</table>\n' +
                    '</body>\n' +
                    '</html>\n',
            }
        },
        mounted() {
            this.initCKEditor()
            CKEDITOR.instances.textEditor.setData(this.text)
            this.getContent()
        },
        methods: {
            initCKEditor() {
                this.editor = CKEDITOR.replace('textEditor', {
                    uiColor: '#3a9edc',
                    width: '100%',
                    height: screen.height * 0.77,
                    toolbar: [
                        ['Source', 'Save', 'Preview'],
                        ['Find', 'Scayt'],
                        ['Bold', 'Italic', 'Underline', 'Blockquote', '-', 'Link', 'Unlink', '-', 'Image', 'Smiley', 'oembed']
                    ]
                });
                CKEDITOR.plugins.registered['save'] =
                    {
                        init : function( editor )
                        {
                            editor.addCommand( 'save',
                                {
                                    modes : { wysiwyg:1, source:1 },
                                    exec : function( editor ) {
                                        let content =editor.getData();
                                        axios.post('/text/doc', {fileName: 'test.doc', content: content}).then(results => {
                                            alert(results.data.msg)
                                        })
                                    }
                                }
                            );
                            editor.ui.addButton( 'Save', {label : '保存', command : 'save'} );
                        }
                    }

            },
            getContent(){
                axios.get('/text/doc', {params: {'fileName': '1190201115陈宇豪.doc'}}).then(results => {
                    this.text = results.data.data
                    CKEDITOR.instances.textEditor.setData(this.text)
                })
            }
        },

    })
</script>
</body>
</html>