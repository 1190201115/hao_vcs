<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文档编辑器</title>
    <script src="../js/outService.js"></script>
    <script src="../ckeditor/ckeditor.js"></script>
</head>
<body>
<div id="app">
    <textarea id="textEditor">
    </textarea>
</div>

<script>
    var vm = new Vue({
        el: "#app",
        data() {
            return {
                editor: null,
                text: 'if you see this, please refresh',
            }
        },
        mounted() {
            this.initCKEditor()
            this.getContent()
        },
        methods: {
            initCKEditor() {
                this.editor = CKEDITOR.replace('textEditor', {
                    uiColor: '#3a9edc',
                    width: '100%',
                    height: screen.height * 0.77,
                    toolbar: [
                        ['Source', 'Save', 'Preview'],
                        ['Find', 'Scayt'],
                        ['Bold', 'Italic', 'Underline', 'Blockquote', '-', 'Link', 'Unlink', '-', 'Image', 'Smiley', 'oembed']
                    ]
                });
                CKEDITOR.plugins.registered['save'] =
                    {
                        init : function( editor )
                        {
                            editor.addCommand( 'save',
                                {
                                    modes : { wysiwyg:1, source:1 },
                                    exec : function( editor ) {
                                        let content =editor.getData();
                                        axios.post('/text/doc', {fileName: 'test.doc', content: content}).then(results => {
                                            alert(results.data.msg)
                                        })
                                    }
                                }
                            );
                            editor.ui.addButton( 'Save', {label : '保存', command : 'save'} );
                        }
                    }

            },
            getContent(){
                axios.get('/text/doc', {params: {'fileName': '1190201115陈宇豪.doc'}}).then(results => {
                    this.text = results.data.data
                    CKEDITOR.instances.textEditor.setData(this.text)
                })
            }
        },

    })
</script>
</body>
</html>